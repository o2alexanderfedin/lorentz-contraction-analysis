<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Laser Trigger System - P‚ÇÄ Motion with Laser Signaling</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: white;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            color: #333;
        }
        
        h1 {
            text-align: center;
            color: #764ba2;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .canvas-container {
            position: relative;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        canvas {
            display: block;
            margin: 0 auto;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .control-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        
        .control-group .value {
            text-align: center;
            font-size: 1.2em;
            color: #764ba2;
            font-weight: bold;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
            width: 100%;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(118, 75, 162, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .info-panel {
            background: linear-gradient(135deg, #f0e6ff 0%, #e6f2ff 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #764ba2;
        }
        
        .info-panel h3 {
            color: #764ba2;
            margin-bottom: 10px;
        }
        
        .info-panel p {
            line-height: 1.6;
            color: #4a5568;
            margin-bottom: 10px;
        }
        
        .phase-indicators {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .phase-box {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            text-align: center;
        }
        
        .phase-box.active {
            border-color: #764ba2;
            background: linear-gradient(135deg, #f0e6ff 0%, #e6f2ff 100%);
        }
        
        .phase-box h4 {
            color: #764ba2;
            margin-bottom: 5px;
        }
        
        .phase-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .phase-label {
            color: #718096;
            font-size: 0.9em;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Particle Laser Trigger System</h1>
        <p class="subtitle">P‚ÇÄ Motion with Laser Triggering at T‚ÇÄ and Detection at T‚ÇÇ</p>
        
        <div class="canvas-container">
            <canvas id="motionCanvas" width="1000" height="500"></canvas>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="acceleration">Acceleration G (m/s¬≤)</label>
                <input type="range" id="acceleration" min="1" max="10" value="5" step="0.5">
                <div class="value" id="accelerationValue">5.0 m/s¬≤</div>
            </div>
            
            <div class="control-group">
                <label for="t1Time">T‚ÇÅ Time (seconds)</label>
                <input type="range" id="t1Time" min="1" max="5" value="2" step="0.1">
                <div class="value" id="t1Value">2.0 s</div>
            </div>
            
            <div class="control-group">
                <label for="t2Time">T‚ÇÇ Time (seconds)</label>
                <input type="range" id="t2Time" min="3" max="10" value="5" step="0.1">
                <div class="value" id="t2Value">5.0 s</div>
            </div>
            
            <div class="control-group">
                <button onclick="startAnimation()">‚ñ∂Ô∏è Start Motion</button>
            </div>
        </div>
        
        <div class="phase-indicators">
            <div class="phase-box" id="phase-t0">
                <h4>T‚ÇÄ: Start Signal</h4>
                <div class="phase-value" id="x0Value">X‚ÇÄ</div>
                <div class="phase-label">Laser triggers acceleration</div>
            </div>
            <div class="phase-box" id="phase-t1">
                <h4>T‚ÇÅ: End Acceleration</h4>
                <div class="phase-value" id="x1Value">X‚ÇÅ</div>
                <div class="phase-label">Constant velocity begins</div>
            </div>
            <div class="phase-box" id="phase-t2">
                <h4>T‚ÇÇ: Detection</h4>
                <div class="phase-value" id="x2Value">X‚ÇÇ</div>
                <div class="phase-label">Laser detects position</div>
            </div>
        </div>
        
        <div class="info-panel">
            <h3>üìä Motion Phases with Laser Detection</h3>
            <p>
                <strong>T‚ÇÄ (Start):</strong> P‚ÇÄ is at rest at position X‚ÇÄ. Laser detector at X‚ÇÄ triggers P‚ÇÄ to begin accelerating with constant acceleration G.
            </p>
            <p>
                <strong>T‚ÇÄ ‚Üí T‚ÇÅ (Acceleration):</strong> P‚ÇÄ accelerates uniformly. Position: x(t) = X‚ÇÄ + ¬ΩG(t-T‚ÇÄ)¬≤. Velocity: v(t) = G(t-T‚ÇÄ).
            </p>
            <p>
                <strong>T‚ÇÅ (Transition):</strong> Laser detector at X‚ÇÅ registers P‚ÇÄ passing through. P‚ÇÄ stops accelerating and continues with constant velocity V‚ÇÅ = G(T‚ÇÅ-T‚ÇÄ).
            </p>
            <p>
                <strong>T‚ÇÅ ‚Üí T‚ÇÇ (Uniform Motion):</strong> P‚ÇÄ moves at constant velocity. Position: x(t) = X‚ÇÅ + V‚ÇÅ(t-T‚ÇÅ).
            </p>
            <p>
                <strong>T‚ÇÇ (Final Detection):</strong> Laser detector at X‚ÇÇ registers P‚ÇÄ at position X‚ÇÇ = X‚ÇÅ + V‚ÇÅ(T‚ÇÇ-T‚ÇÅ).
            </p>
            <p style="margin-top: 10px; font-style: italic;">
                All three positions X‚ÇÄ, X‚ÇÅ, and X‚ÇÇ have laser detectors that register P‚ÇÄ as it passes through each location.
            </p>
        </div>
    </div>
    
    <script>
        const canvas = document.getElementById('motionCanvas');
        const ctx = canvas.getContext('2d');
        
        // Particle class for reusable particle objects
        class Particle {
            constructor(name, x0, color = '#764ba2') {
                this.name = name;
                this.x0 = x0;
                this.x = x0;
                this.y = 400;
                this.color = color;
                this.isActive = false;
                this.velocity = 0;
            }
            
            updatePosition(x) {
                this.x = x;
            }
            
            draw(ctx) {
                // Draw particle
                ctx.fillStyle = this.isActive ? this.color : '#cbd5e0';
                ctx.beginPath();
                ctx.arc(this.x, this.y, 15, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.strokeStyle = this.isActive ? '#553c9a' : '#a0aec0';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // Label
                ctx.fillStyle = 'white';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(this.name, this.x, this.y + 5);
                
                // Motion arrow if moving
                if (this.isActive && this.x > this.x0 + 10) {
                    ctx.strokeStyle = '#48bb78';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(this.x + 20, this.y);
                    ctx.lineTo(this.x + 60, this.y);
                    ctx.stroke();
                    
                    // Arrowhead
                    ctx.beginPath();
                    ctx.moveTo(this.x + 60, this.y);
                    ctx.lineTo(this.x + 50, this.y - 8);
                    ctx.lineTo(this.x + 50, this.y + 8);
                    ctx.closePath();
                    ctx.fillStyle = '#48bb78';
                    ctx.fill();
                }
            }
        }
        
        // LaserDetector class for reusable laser detectors
        class LaserDetector {
            constructor(x, label, color, detectionRange = 20) {
                this.x = x;
                this.y = 100;
                this.label = label;
                this.color = color;
                this.detectionRange = detectionRange;
                this.isDetecting = false;
            }
            
            checkDetection(particleX) {
                this.isDetecting = Math.abs(particleX - this.x) < this.detectionRange;
                return this.isDetecting;
            }
            
            draw(ctx) {
                // Laser emitter with blinking effect
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.isDetecting ? 1 : 0.4;
                ctx.fillRect(this.x - 15, this.y - 30, 30, 25);
                
                // Laser beam (vertical) with blinking
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 3;
                ctx.setLineDash([10, 5]);
                ctx.globalAlpha = this.isDetecting ? 0.8 : 0.2;
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x, 400);
                ctx.stroke();
                ctx.globalAlpha = 1;
                ctx.setLineDash([]);
                
                // Add glow effect when detecting
                if (this.isDetecting) {
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = this.color;
                    ctx.fillStyle = this.color;
                    ctx.globalAlpha = 0.3;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y - 15, 25, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    ctx.globalAlpha = 1;
                }
                
                // Label
                ctx.fillStyle = '#2d3748';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(this.label, this.x, this.y - 40);
            }
        }
        
        // ParticleSystem class to manage particle and lasers together
        class ParticleSystem {
            constructor(particle, lasers = []) {
                this.particle = particle;
                this.lasers = lasers;
                this.scale = 30;
                this.elapsed = 0;
                this.phase = 'idle';
                this.G = 5;
                this.T1 = 2;
                this.T2 = 5;
                this.isRunning = false;
            }
            
            reset() {
                this.elapsed = 0;
                this.phase = 'idle';
                this.particle.x = this.particle.x0;
                this.particle.isActive = false;
                this.particle.velocity = 0;
                this.isRunning = false;
            }
            
            start(G, T1, T2) {
                this.G = G;
                this.T1 = T1;
                this.T2 = T2;
                this.elapsed = 0;
                this.isRunning = true;
                this.particle.isActive = true;
            }
            
            step(deltaTime) {
                if (!this.isRunning) return;
                
                this.elapsed += deltaTime;
                let x, velocity;
                
                if (this.elapsed < this.T1) {
                    // Phase 1: Acceleration
                    this.phase = 'accelerating';
                    x = this.particle.x0 + 0.5 * this.G * this.elapsed * this.elapsed * this.scale;
                    velocity = this.G * this.elapsed;
                } else if (this.elapsed < this.T2) {
                    // Phase 2: Uniform motion
                    this.phase = 'uniform';
                    const V1 = this.G * this.T1;
                    const X1 = this.particle.x0 + 0.5 * this.G * this.T1 * this.T1 * this.scale;
                    x = X1 + V1 * (this.elapsed - this.T1) * this.scale;
                    velocity = V1;
                } else {
                    // Phase 3: Detection complete
                    this.phase = 'detected';
                    const V1 = this.G * this.T1;
                    const X1 = this.particle.x0 + 0.5 * this.G * this.T1 * this.T1 * this.scale;
                    x = Math.min(X1 + V1 * (this.T2 - this.T1) * this.scale, 850);
                    velocity = V1;
                    
                    // Stop after detection
                    if (this.elapsed > this.T2 + 1) {
                        this.isRunning = false;
                    }
                }
                
                this.particle.updatePosition(x);
                this.particle.velocity = velocity;
                
                // Update laser detection states
                this.lasers.forEach(laser => {
                    laser.checkDetection(this.particle.x);
                });
                
                return this.phase;
            }
            
            draw(ctx) {
                // Draw all lasers
                this.lasers.forEach(laser => laser.draw(ctx));
                
                // Draw particle
                this.particle.draw(ctx);
                
                // Draw motion trail if particle is moving
                if (this.particle.isActive && this.particle.x > this.particle.x0) {
                    ctx.strokeStyle = 'rgba(118, 75, 162, 0.3)';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 3]);
                    ctx.beginPath();
                    ctx.moveTo(this.particle.x0, 400);
                    ctx.lineTo(this.particle.x - 15, 400);
                    ctx.stroke();
                    ctx.setLineDash([]);
                }
            }
            
            getElapsed() {
                return this.elapsed;
            }
            
            getPhase() {
                return this.phase;
            }
        }
        
        let animationId = null;
        let startTime = null;
        let currentPhase = 'idle';
        
        // Physics parameters
        let G = 5; // acceleration
        let T1 = 2; // time when acceleration stops
        let T2 = 5; // time of detection
        let X0 = 100; // initial position
        
        // Initialize particle and laser system
        const particle = new Particle('P‚ÇÄ', X0);
        const scale = 30;
        
        // Calculate laser positions
        function calculatePositions() {
            const X1 = X0 + 0.5 * G * T1 * T1 * scale;
            const V1 = G * T1;
            const X2 = Math.min(X1 + V1 * (T2 - T1) * scale, 850);
            return { X1, X2, V1 };
        }
        
        let positions = calculatePositions();
        
        // Create laser detectors
        const lasers = [
            new LaserDetector(X0, 'Laser T‚ÇÄ', '#48bb78'),
            new LaserDetector(positions.X1, 'Laser T‚ÇÅ', '#f6ad55'),
            new LaserDetector(positions.X2, 'Laser T‚ÇÇ', '#f56565')
        ];
        
        // Create particle system
        const particleSystem = new ParticleSystem(particle, lasers);
        
        function drawStaticElements() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw coordinate system
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 2;
            
            // X-axis
            ctx.beginPath();
            ctx.moveTo(50, 400);
            ctx.lineTo(950, 400);
            ctx.stroke();
            
            // Draw ticks and labels
            ctx.fillStyle = '#4a5568';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            
            // Update positions
            positions = calculatePositions();
            
            // Update laser positions
            lasers[1].x = positions.X1;
            lasers[2].x = positions.X2;
            
            // X‚ÇÄ marker
            ctx.beginPath();
            ctx.moveTo(X0, 395);
            ctx.lineTo(X0, 405);
            ctx.stroke();
            ctx.fillText('X‚ÇÄ', X0, 425);
            
            // X‚ÇÅ marker
            ctx.beginPath();
            ctx.moveTo(positions.X1, 395);
            ctx.lineTo(positions.X1, 405);
            ctx.stroke();
            ctx.fillText('X‚ÇÅ', positions.X1, 425);
            
            // X‚ÇÇ marker
            ctx.beginPath();
            ctx.moveTo(positions.X2, 395);
            ctx.lineTo(positions.X2, 405);
            ctx.stroke();
            ctx.fillText('X‚ÇÇ', positions.X2, 425);
            
            return positions;
        }
        
        // Note: drawLaser and drawParticle functions are now replaced by class methods
        
        let lastTime = 0;
        
        function animate(timestamp) {
            if (!startTime) {
                startTime = timestamp;
                lastTime = timestamp;
            }
            
            // Calculate delta time in seconds
            const deltaTime = (timestamp - lastTime) / 1000;
            lastTime = timestamp;
            
            // Draw static elements
            const positions = drawStaticElements();
            
            // Step the particle system
            const phase = particleSystem.step(deltaTime);
            
            // Update phase indicators
            document.querySelectorAll('.phase-box').forEach(box => box.classList.remove('active'));
            
            switch(phase) {
                case 'accelerating':
                    document.getElementById('phase-t0').classList.add('active');
                    break;
                case 'uniform':
                    document.getElementById('phase-t1').classList.add('active');
                    break;
                case 'detected':
                    document.getElementById('phase-t2').classList.add('active');
                    break;
            }
            
            // Draw particle system (particle and lasers)
            particleSystem.draw(ctx);
            
            // Update position displays
            document.getElementById('x0Value').textContent = '0 m';
            document.getElementById('x1Value').textContent = (0.5 * G * T1 * T1).toFixed(1) + ' m';
            const V1 = G * T1;
            document.getElementById('x2Value').textContent = (0.5 * G * T1 * T1 + V1 * (T2 - T1)).toFixed(1) + ' m';
            
            // Continue animation if still running
            if (particleSystem.isRunning) {
                animationId = requestAnimationFrame(animate);
            } else if (particleSystem.getElapsed() > T2) {
                // Reset after completion
                setTimeout(() => {
                    particleSystem.reset();
                    drawStaticElements();
                    particleSystem.draw(ctx);
                }, 1000);
            }
        }
        
        function startAnimation() {
            // Cancel any existing animation
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            
            // Reset
            startTime = null;
            lastTime = 0;
            
            // Get current parameters
            G = parseFloat(document.getElementById('acceleration').value);
            T1 = parseFloat(document.getElementById('t1Time').value);
            T2 = parseFloat(document.getElementById('t2Time').value);
            
            // Start particle system with new parameters
            particleSystem.start(G, T1, T2);
            
            // Start animation
            animationId = requestAnimationFrame(animate);
        }
        
        // Update display values
        document.getElementById('acceleration').addEventListener('input', (e) => {
            document.getElementById('accelerationValue').textContent = parseFloat(e.target.value).toFixed(1) + ' m/s¬≤';
            G = parseFloat(e.target.value);
            drawStaticElements();
            drawParticle(X0, 400, false);
        });
        
        document.getElementById('t1Time').addEventListener('input', (e) => {
            document.getElementById('t1Value').textContent = parseFloat(e.target.value).toFixed(1) + ' s';
            T1 = parseFloat(e.target.value);
            // Ensure T2 > T1
            const t2Slider = document.getElementById('t2Time');
            if (parseFloat(t2Slider.value) <= T1) {
                t2Slider.value = T1 + 1;
                document.getElementById('t2Value').textContent = (T1 + 1).toFixed(1) + ' s';
                T2 = T1 + 1;
            }
            drawStaticElements();
            drawParticle(X0, 400, false);
        });
        
        document.getElementById('t2Time').addEventListener('input', (e) => {
            const newT2 = parseFloat(e.target.value);
            if (newT2 > T1) {
                document.getElementById('t2Value').textContent = newT2.toFixed(1) + ' s';
                T2 = newT2;
                drawStaticElements();
                drawParticle(X0, 400, false);
            } else {
                e.target.value = T1 + 1;
                document.getElementById('t2Value').textContent = (T1 + 1).toFixed(1) + ' s';
                T2 = T1 + 1;
            }
        });
        
        // Initial draw
        drawStaticElements();
        particleSystem.draw(ctx);
    </script>
</body>
</html>